// -*- groovy -*-
// METABUILD GENERATED metaconf/metaconf.groovy + metaconf/project/make.gradle.tmpl -> atlasdb/commons-db/make.gradle
apply from: "${rootProject.projectDir}/before.gradle"
sourceSets.main.java.srcDirs=[ file('src/main/java') ]
sourceSets.main.resources.srcDirs=[  ]
sourceSets.test.java.srcDirs=[  ]
sourceSets.test.resources.srcDirs=[  ]
sourceCompatibility = '1.6'
targetCompatibility = '1.6'
archivesBaseName="commons-db"
configurations.create('test').extendsFrom(configurations.testRuntime)
jar {
  baseName 'commons-db'
  exclude '.gitkeep'
  doFirst {
    manifest {
      from rootProject.ext.standardManifest
      def jarList = processJarListForManifest(sourceSets.main.compileClasspath)
      if (!jarList.isEmpty()) {
        attributes.put('Class-Path', jarList.join(' '))
      }
    }
  }
  doLast {
    recordArtifactName(archiveName, archivePath)
  }
}
task testJar(type: Jar) {
  baseName 'commons-db-test'
  from sourceSets.test.output
  exclude '.gitkeep'
  ext.is_test = true
  doFirst {
    manifest {
      from rootProject.ext.standardManifest
      def jarList = processJarListForManifest(sourceSets.test.compileClasspath)
      if (!jarList.isEmpty()) {
        attributes.put('Class-Path', jarList.join(' '))
      }
    }
  }
  doLast {
    recordArtifactName(archiveName, archivePath)
  }
}
assemble.dependsOn testJar
task mainSourcesZip(type: Zip) {
  baseName 'commons-db'
  from sourceSets.main.allSource
}
assemble.dependsOn mainSourcesZip
task testSourcesZip(type: Zip) {
  baseName 'commons-db-test'
  from sourceSets.test.allSource
}
assemble.dependsOn testSourcesZip
def sourceSetEmpty(def sourceSet) {
  return sourceSet.allSource.isEmpty() ||
    (sourceSet.allSource.files.size() == 1 &&
    sourceSet.allSource.singleFile.name.equals(".gitkeep"))
}
publishing {
publications {
  ivy(IvyPublication) {
    if (!sourceSetEmpty(sourceSets.main)) {
      artifact(mainSourcesZip) {
        name "commons-db"
        extension "zip"
        type "source"
        conf "default"
      }
    }
    if (!sourceSetEmpty(sourceSets.test)) {
      artifact(testSourcesZip) {
        name "commons-db-test"
        extension "zip"
        type "source"
        conf "test"
      }
    }
  }
}
}
dependencies {
  test sourceSets.test.output
  compile(group: 'commons-dbutils', name: 'commons-dbutils', version: '1.3', configuration: 'default')
  compile(group: 'commons-lang', name: 'commons-lang', version: '2.6', configuration: 'default')
  compile(group: 'commons-io', name: 'commons-io', version: '2.1', configuration: 'default')
  compile(group: 'log4j', name: 'log4j', version: '1.2.17', configuration: 'default')
  {
    transitive = false
  }
  compile(group: 'com.mchange', name: 'c3p0', version: '0.9.5.1', configuration: 'default')
  compile(group: 'org.postgresql', name: 'postgresql', version: '9.4.1207.jre7', configuration: 'default')
  {
    exclude(
      module: 'waffle-jna',
    )
  }
  compile(group: 'com.zaxxer', name: 'HikariCP', version: '2.4.5', configuration: 'default')
  {
    exclude(
      group: 'org.slf4j',
    )
  }
  compile(group: 'joda-time', name: 'joda-time', version: '2.9.2', configuration: 'default')
  testCompile(group: 'junit', name: 'junit', version: '4.11', configuration: 'default')
  testCompile(project(path: ':commons-api', configuration: 'test'))
  compile(project(path: ':commons-api', configuration: 'default'))
  testCompile(project(path: ':commons-proxy', configuration: 'test'))
  compile(project(path: ':commons-proxy', configuration: 'default'))
  testCompile(project(path: ':atlasdb-papaya', configuration: 'test'))
  compile(project(path: ':atlasdb-papaya', configuration: 'default'))
}
apply from: "${rootProject.projectDir}/after.gradle"
